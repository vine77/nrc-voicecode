<HTML>
<HEAD>
<TITLE>VoiceCode User Manual</TITLE>
</HEAD>

<BODY   BGCOLOR="#ffffff">


<MAP NAME="banner_top">
    <AREA SHAPE="rect" COORDS="588,14,620,40" HREF="http://www.iit.nrc.ca/english.html">
    <AREA SHAPE="rect" COORDS="538,14,583,37" HREF="http://www.nrc.ca/corporate/english/">
    <AREA SHAPE="rect" COORDS="86,4,421,37" HREF="http://www.iit.nrc.ca/II_public/index.html">
</MAP>
<table cellpadding="5" cellspacing="0" border="0" width="100%">
<tr>
<td valign="bottom" align="left">
<IMG SRC="http://www.iit.nrc.ca/II_public/images/banner_top.jpg" width="620" height="37" alt="II Group Banner" USEMAP="#banner_top"
ISMAP border="0"><BR><IMG SRC="http://www.iit.nrc.ca/II_public/images/banner_voicecode.gif" width="230" height="50" alt="II VoiceGrip"></td>
</tr>
<tr><td>&nbsp;</td></tr>
</table>


<H1><FONT COLOR="#400080">VoiceCode User manual</FONT></H1>


<UL>
<LI><A HREF="#simulation">Simulation mode</A>
<LI><A HREF="#config">Configuring VoiceCode</A>
    <UL>
    <LI><A HREF="#debugConfig">Debugging the configuration file</A>
    </UL>
</UL>

VoiceCode is currently at the prototype stage. It cannot be used in an
actual operational setting. You can however test some of the
functionality of the system by running it in simulation mode. This
simulation mode allows you to dictate code and see the result of those
operations.

<P>

<H2><A NAME="simulation">Simulation mode</A></H2>


To run VoiceCode in simulation mode, just type:


<PRE>
cd %VCODE_HOME%\Mediator
python mediator.py -s
</PRE>

VoiceCode will then prompt your for commands and execute them. After
executing each command, the content of the simulator's current buffer
will be output to the screen. The tag <EM><CURSOR></EM> is used to
denote the position of the cursor.

<P>

The available commands are:

<PRE>
openfile(STR fname)
   Opens file with path name *fname* in the editor simulator

say(STR utterance)
   Interprets string *utterance* as though it had been said by a user.

   When called in this way, the system will simulate a recognition
   event using NatLink's <EM>recognitionMimic</EM> function.

say(STR utterance, bypass_NatLink=1)
   Same as above, except that the interpretation process will bypass
   NatLink's <EM>recognitionMimic</EM> function.

goto(INT pos)
   Moves cursor to position *pos*

gotoline(INT linenum)
   Moves cursor to the beginning of line number *linenum*

showbuff()
   Prints the content of the current buffer

listen()
   Throws the mediator into a dictation loop. It will listen for
   dictation utterances and interpret and execute any part of the
   utterance that corresponds to a Context Sensitive Command.

   Once in 'listen' mode, you cannot type console commands until you
   have clicked the 'OK' button on the 'Natlink/ Python Subsystem'
   window.

quit()
   Quit the simulator. 

   Note that if you don't quit using this command
   (e.g. <EM>Ctrl-C</EM>), your DOS window will hang up.

</PRE>


For example, if you do the following:

<UL>
<LI>python mediator.py -s
<LI>openfile('C:/Temp/blah.c')
<LI>listen()
<LI>say: <EM>"for loop index after semi index after equal function xray comma yankee at index 0 after semi index loop body"</EM>
</UL>

then you should end up with the following code:

<PRE>
1:   for (index=0; index <= function(x, y[0]); index++)
2:   {
3: <CURSOR>
4:   }
</PRE>

<H2><A NAME="config">Configuring VoiceCode</A></H2>

At the center of VoiceCode is a concept called <EM>Context Sensitive
Command (CSC)</EM>. A CSC is an utterance which may fire a particular
action in a particular context.

<P>

VoiceCode comes bundled with a series of CSCs for doing common
tasks. If you do not like the way a particular CSC is implemented (for
example, if you don't like the way it is said) or if you want to add
your own CSC, you can do that by editing the configuration file
<EM>VCODE_HOME/Config/vc_config.py</EM>. All the CSC known to
VoiceCode are defined in that file through Python statements that look
like this:


<PRE>
acmd = CSCmd(spoken_forms=['at index'], 
             meanings=[[ContC(), gen_brackets_pair], 
                       [ContPy(), gen_brackets_pair]])
add_csc(acmd)
</PRE>

Basically, these two statements create a new instance of <A
HREF="CSCmd.CSCmd.html">CSCmd</A> which defines a CSC, and then
register that instance with VoiceCode through the <EM>add_csc</EM>
function.

<P>


The <EM>CSCmd</EM> constructor has the following named arguments:

<DL>
<DT><STRONG>[STR] spoken_forms</STRONG> 
<DD>the <EM>spoken_form</EM> argument
is a list defining the various ways that the command can be invoked by
voice. If you prefer to use a different voice command, just add your
own to that list. 

<P>

<DT><STRONG>[[Context, FCT]] meanings</STRONG>  
<DD>the <EM>meanings</EM> argument is a list of contextual meanings for the command. Each contextual meaning is a pair consisting of a context object (which is used to determine if a particular context applies) and an action function to be fired if the context applies.

</DL>

In the above example, the command has only one spoken form <EM>'at
index'</EM>. The command can be used in one of two contexts,
<EM>ContC</EM> and <EM>ContPy</EM> (which respectively apply iif the
current source buffer is in <EM>C</EM> or <EM>Python</EM>). In both
contexts, the action function is <EM>gen_brackets_pair</EM> which
simply inserts a pair of square brackets and positions the cursor in
between.

<P>

The various <A HREF="Context.Context.html">Context</A> object and the
various <EM>action</EM> functions that can be used to build <A
HREF="CSCmd.CSCmd.html">CSCmd</A> objects are defined in the following
files:

<P>

<UL>
<LI><STRONG>$VCODE_HOME/Mediator/cont_gen.py: </STRONG> defines context objects which are not specific to a particular programming language
<LI><STRONG>$VCODE_HOME/Mediator/actions_gen.py:</STRONG> defines action functions which are relevant across different programming languages.
<LI><STRONG>$VCODE_HOME/Mediator/actions_C_Cpp.py:</STRONG> defines action functions relevant only for the <EM>C</EM> and <EM>C++</EM> languages.
<LI><STRONG>$VCODE_HOME/Mediator/actions_py.py:</STRONG> defines action functions relevant only for the <EM>Python</EM> language.
</UL>

Of course, you are not limited to those contexts and actions. You can add your own and then use them to build <A HREF="CSCmd.CSCmd.html">CSCmd</A> objects in <EM>vc_config.py</EM>.


<H3><A NAME="debugConfig">Debugging the configuration file</A></H3>

The file <EM>vc_config.py</EM> is evaluated at run time by VoiceCode. If there are syntax errors in that file, the error reporting will therefore not be as precise as usual. You will probably get a message like:

<PRE>
ERROR: in configuration file D:\VoiceCode\VCode\Config\vc_config.py.

Traceback (innermost last):
  File "mediator.py", line 89, in ?
    raise err
</PRE>

with no indication of the line in <EM>vc_config.py</EM> where the error occurred. You can however get better error reporting by running vc_config.py directly from python as follows:

<PRE>
python %VCODE_HOME%\Config\vc_config.py
</PRE>


<hr>
<center>
<TABLE  border="1" >
    <tr><td><font size=2>
    [<A HREF="http://ii2.ai.iit.nrc.ca/VoiceCode/">VoiceCode Home</A> |
    <A HREF="http://ii2.ai.iit.nrc.ca/VoiceCode/contact.html">Contact</A> |
    <A HREF="http://ii2.ai.iit.nrc.ca/VoiceCode/pbvResources.html">PBV Resources</A> |
    <A HREF="http://www.iit.nrc.ca/english.html">IIT</A> |
    <A HREF="http://www.nrc.ca/corporate/english/">NRC</A> |
    <A HREF="mailto:alain.desilets@nrc.ca">Feedback</A> ]
    </FONT></td>
   </tr>
</table>
</center>


</BODY>
</HTML>